# Get the commit message
commit_msg=$(cat "$1")

# Remove comments for validation
commit_msg_no_comments=$(echo "$commit_msg" | grep -v '^#')

# Check if commit message follows conventional format with emoji
emoji_pattern="^(âœ¨|ğŸ›|ğŸ“–|ğŸ’„|ğŸ› |âš¡ï¸|âœ…|ğŸ“¦|âš™ï¸|ğŸš€|ğŸ—‘|ğŸ¤|ğŸ‰)"
type_pattern="(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert|try|init)"

if ! echo "$commit_msg_no_comments" | grep -qE "$emoji_pattern.*$type_pattern:"; then
  echo ""
  echo "âŒ Invalid commit message format!"
  echo ""
  echo "âœ… Correct format: <emoji> <type>: <subject>"
  echo ""
  echo "Examples:"
  echo "  âœ¨ feat: add new authentication system"
  echo "  ğŸ› fix: resolve navigation bug on mobile"
  echo "  ğŸ“– docs: update API documentation"
  echo "  ğŸ’„ style: improve button hover effects"
  echo ""
  echo "Available types:"
  echo "  âœ¨  feat      ğŸ›  fix       ğŸ“–  docs"
  echo "  ğŸ’„  style     ğŸ›   refactor  âš¡ï¸  perf"
  echo "  âœ…  test      ğŸ“¦  build     âš™ï¸  ci"
  echo "  ğŸš€  chore     ğŸ—‘  revert    ğŸ¤  try"
  echo "  ğŸ‰  init"
  echo ""
  exit 1
fi
