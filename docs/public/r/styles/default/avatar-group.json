{
  "name": "avatar-group",
  "type": "registry:ui",
  "dependencies": [
    "@radix-ui/react-slot",
    "class-variance-authority",
    "motion"
  ],
  "files": [
    {
      "path": "ui/avatar-group.tsx",
      "content": "import { Slot } from \"@radix-ui/react-slot\";\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport { AnimatePresence, motion, type Variants } from \"motion/react\";\nimport * as React from \"react\";\n\nconst avatarGroupVariants = cva(\"flex items-center\", {\n  variants: {\n    orientation: {\n      horizontal: \"flex-row\",\n      vertical: \"flex-col\",\n    },\n    dir: {\n      ltr: \"\",\n      rtl: \"\",\n    },\n  },\n  compoundVariants: [\n    {\n      orientation: \"horizontal\",\n      dir: \"ltr\",\n      className: \"-space-x-1\",\n    },\n    {\n      orientation: \"horizontal\",\n      dir: \"rtl\",\n      className: \"-space-x-1 flex-row-reverse space-x-reverse\",\n    },\n    {\n      orientation: \"vertical\",\n      dir: \"ltr\",\n      className: \"-space-y-1\",\n    },\n    {\n      orientation: \"vertical\",\n      dir: \"rtl\",\n      className: \"-space-y-1 flex-col-reverse space-y-reverse\",\n    },\n  ],\n  defaultVariants: {\n    orientation: \"horizontal\",\n    dir: \"ltr\",\n  },\n});\n\nexport interface AvatarGroupProps\n  extends Omit<React.ComponentProps<\"div\">, \"dir\">,\n    VariantProps<typeof avatarGroupVariants> {\n  size?: number;\n  max?: number;\n  asChild?: boolean;\n  reverse?: boolean;\n  tooltipPlacement?: \"top\" | \"bottom\" | \"left\" | \"right\";\n}\n\nexport function AvatarGroup(props: AvatarGroupProps) {\n  const {\n    orientation = \"horizontal\",\n    dir = \"ltr\",\n    size = 40,\n    max,\n    asChild,\n    reverse = false,\n    tooltipPlacement = \"top\",\n    className,\n    children,\n    ...rootProps\n  } = props;\n\n  const childrenArray = React.Children.toArray(children).filter(\n    React.isValidElement,\n  );\n  const itemCount = childrenArray.length;\n  const shouldTruncate = max && itemCount > max;\n  const visibleItems = shouldTruncate\n    ? childrenArray.slice(0, max - 1)\n    : childrenArray;\n  const overflowCount = shouldTruncate ? itemCount - (max - 1) : 0;\n  const totalRenderedItems = shouldTruncate ? max : itemCount;\n\n  // Generate unique IDs for each avatar to ensure complete isolation\n  const uniqueIds = React.useMemo(\n    () => visibleItems.map((_, i) => `avatar-${Math.random().toString(36).substr(2, 9)}-${i}`),\n    [visibleItems.length],\n  );\n\n  const RootPrimitive = asChild ? Slot : \"div\";\n\n  return (\n    <RootPrimitive\n      data-orientation={orientation}\n      data-slot=\"avatar-group\"\n      {...rootProps}\n      className={cn(avatarGroupVariants({ orientation, dir }), className)}\n    >\n      {visibleItems.map((child, index) => {\n        const uniqueId = uniqueIds[index] || `avatar-fallback-${index}`;\n        return (\n          <AvatarGroupItem\n            key={uniqueId}\n            uniqueId={uniqueId}\n            child={child}\n            index={index}\n            itemCount={totalRenderedItems}\n            orientation={orientation}\n            dir={dir}\n            size={size}\n            reverse={reverse}\n            tooltipPlacement={tooltipPlacement || \"top\"}\n          />\n        );\n      })}\n      {shouldTruncate && (\n        <AvatarGroupItem\n          key=\"overflow-item\"\n          uniqueId=\"overflow-item\"\n          child={\n            <div className=\"flex size-full items-center justify-center rounded-full bg-muted font-medium text-muted-foreground text-xs\">\n              +{overflowCount}\n            </div>\n          }\n          index={visibleItems.length}\n          itemCount={totalRenderedItems}\n          orientation={orientation}\n          dir={dir}\n          size={size}\n          reverse={reverse}\n          tooltipPlacement={tooltipPlacement || \"top\"}\n        />\n      )}\n    </RootPrimitive>\n  );\n}\n\ninterface AvatarGroupItemProps\n  extends Omit<React.ComponentProps<typeof Slot>, \"dir\">,\n    VariantProps<typeof avatarGroupVariants> {\n  uniqueId: string;\n  child: React.ReactElement;\n  index: number;\n  itemCount: number;\n  size: number;\n  reverse: boolean;\n  tooltipPlacement: \"top\" | \"bottom\" | \"left\" | \"right\";\n}\n\nconst itemVariants: Variants = {\n  hidden: {\n    opacity: 0,\n    scale: 0,\n    y: -20,\n  },\n  visible: (index: number) => ({\n    opacity: 1,\n    scale: 1,\n    y: 0,\n    transition: {\n      type: \"spring\",\n      stiffness: 260,\n      damping: 20,\n      delay: index * 0.08,\n    },\n  }),\n};\n\nconst AvatarGroupItem = React.memo(function AvatarGroupItem(props: AvatarGroupItemProps) {\n  const {\n    uniqueId,\n    child,\n    index,\n    size,\n    orientation,\n    dir = \"ltr\",\n    reverse = false,\n    itemCount,\n    tooltipPlacement = \"top\",\n    className,\n    style,\n    ...itemProps\n  } = props;\n\n  const [isHovered, setIsHovered] = React.useState(false);\n  const [tooltipName, setTooltipName] = React.useState<string>(\"\");\n  const [isAnimating, setIsAnimating] = React.useState(false);\n\n  const tooltipPositionClasses = {\n    top: \"-top-12 left-1/2 -translate-x-1/2\",\n    bottom: \"-bottom-12 left-1/2 -translate-x-1/2\",\n    left: \"top-1/2 -left-2 -translate-y-1/2 -translate-x-full\",\n    right: \"top-1/2 -right-2 -translate-y-1/2 translate-x-full\",\n  };\n\n  const tooltipArrowClasses = {\n    top: \"-bottom-1 left-1/2 -translate-x-1/2 rotate-45\",\n    bottom: \"-top-1 left-1/2 -translate-x-1/2 rotate-45\",\n    left: \"top-1/2 -right-1 -translate-y-1/2 rotate-45\",\n    right: \"top-1/2 -left-1 -translate-y-1/2 rotate-45\",\n  };\n\n  const tooltipAnimations = {\n    top: { initial: { y: -10 }, animate: { y: 0 }, exit: { y: -10 } },\n    bottom: { initial: { y: 10 }, animate: { y: 0 }, exit: { y: 10 } },\n    left: { initial: { x: -10 }, animate: { x: 0 }, exit: { x: -10 } },\n    right: { initial: { x: 10 }, animate: { x: 0 }, exit: { x: 10 } },\n  };\n\n  React.useEffect(() => {\n    // Recursive function to find img elements and extract alt/title\n    const extractName = (element: any): string => {\n      if (!React.isValidElement(element)) return \"\";\n\n      const props = element.props as any;\n\n      // Check if this is an img element with alt\n      if (element.type === \"img\" && props?.alt) {\n        return props.alt;\n      }\n\n      // Check direct props\n      if (props?.alt) return props.alt;\n      if (props?.title) return props.title;\n\n      // Recursively check children\n      if (props?.children) {\n        if (React.isValidElement(props.children)) {\n          const childName = extractName(props.children);\n          if (childName) return childName;\n        } else if (Array.isArray(props.children)) {\n          for (const child of props.children) {\n            const childName = extractName(child);\n            if (childName) return childName;\n          }\n        }\n      }\n\n      return \"\";\n    };\n\n    const name = extractName(child);\n    setTooltipName(name);\n  }, [child]);\n\n  const maskStyle = React.useMemo<React.CSSProperties>(() => {\n    let maskImage = \"\";\n\n    let shouldMask = false;\n\n    if (orientation === \"vertical\" && dir === \"rtl\" && reverse) {\n      shouldMask = index !== itemCount - 1;\n    } else {\n      shouldMask = reverse ? index < itemCount - 1 : index > 0;\n    }\n\n    if (shouldMask) {\n      const maskRadius = size / 2;\n      const maskOffset = size / 4 + size / 10;\n\n      if (orientation === \"vertical\") {\n        if (dir === \"ltr\") {\n          if (reverse) {\n            maskImage = `radial-gradient(circle ${maskRadius}px at 50% ${size + maskOffset}px, transparent 99%, white 100%)`;\n          } else {\n            maskImage = `radial-gradient(circle ${maskRadius}px at 50% -${maskOffset}px, transparent 99%, white 100%)`;\n          }\n        } else {\n          if (reverse) {\n            maskImage = `radial-gradient(circle ${maskRadius}px at 50% -${maskOffset}px, transparent 99%, white 100%)`;\n          } else {\n            maskImage = `radial-gradient(circle ${maskRadius}px at 50% ${size + maskOffset}px, transparent 99%, white 100%)`;\n          }\n        }\n      } else {\n        if (dir === \"ltr\") {\n          if (reverse) {\n            maskImage = `radial-gradient(circle ${maskRadius}px at ${size + maskOffset}px 50%, transparent 99%, white 100%)`;\n          } else {\n            maskImage = `radial-gradient(circle ${maskRadius}px at -${maskOffset}px 50%, transparent 99%, white 100%)`;\n          }\n        } else {\n          if (reverse) {\n            maskImage = `radial-gradient(circle ${maskRadius}px at -${maskOffset}px 50%, transparent 99%, white 100%)`;\n          } else {\n            maskImage = `radial-gradient(circle ${maskRadius}px at ${size + maskOffset}px 50%, transparent 99%, white 100%)`;\n          }\n        }\n      }\n    }\n\n    return {\n      width: size,\n      height: size,\n      maskImage,\n    };\n  }, [size, index, orientation, dir, reverse, itemCount]);\n\n  const MotionSlot = motion.create(Slot as any);\n\n  const handleMouseEnter = React.useCallback(() => {\n    setIsHovered(true);\n    setIsAnimating(true);\n  }, []);\n\n  const handleMouseLeave = React.useCallback(() => {\n    setIsHovered(false);\n    setIsAnimating(false);\n  }, []);\n\n  return (\n    <motion.div\n      className=\"relative inline-block\"\n      initial=\"hidden\"\n      animate=\"visible\"\n      custom={index}\n      variants={itemVariants}\n      style={{ zIndex: isAnimating ? 50 : \"auto\" }}\n    >\n      <motion.div\n        animate={\n          isHovered\n            ? {\n                scale: 1.15,\n                y: -8,\n              }\n            : {\n                scale: 1,\n                y: 0,\n              }\n        }\n        transition={{\n          type: \"spring\",\n          stiffness: 400,\n          damping: 17,\n        }}\n      >\n        <MotionSlot\n          data-slot=\"avatar-group-item\"\n          className={cn(\n            \"relative size-full shrink-0 overflow-hidden rounded-full [&_img]:size-full cursor-pointer\",\n            \"before:absolute before:inset-0 before:rounded-full before:border-2 before:border-transparent\",\n            isHovered && \"before:border-primary/50\",\n            \"before:transition-colors before:duration-300\",\n            \"after:absolute after:inset-0 after:rounded-full after:shadow-lg\",\n            isHovered ? \"after:shadow-primary/40\" : \"after:shadow-primary/0\",\n            \"after:transition-shadow after:duration-300\",\n            className,\n          )}\n          style={{\n            ...maskStyle,\n            ...style,\n          }}\n          onMouseEnter={handleMouseEnter}\n          onMouseLeave={handleMouseLeave}\n          {...itemProps}\n        >\n          {child}\n        </MotionSlot>\n      </motion.div>\n      <AnimatePresence mode=\"wait\">\n        {tooltipName && isHovered && (\n          <motion.div\n            key={`tooltip-${uniqueId}`}\n            initial={{\n              opacity: 0,\n              scale: 0.8,\n              ...tooltipAnimations[tooltipPlacement].initial,\n            }}\n            animate={{\n              opacity: 1,\n              scale: 1,\n              ...tooltipAnimations[tooltipPlacement].animate,\n            }}\n            exit={{\n              opacity: 0,\n              scale: 0.8,\n              ...tooltipAnimations[tooltipPlacement].exit,\n            }}\n            transition={{\n              duration: 0.15,\n              ease: \"easeOut\",\n            }}\n            className={`pointer-events-none absolute z-[100] whitespace-nowrap rounded-lg bg-gray-900 dark:bg-gray-100 px-3 py-1.5 text-xs font-medium text-white dark:text-gray-900 shadow-xl ${tooltipPositionClasses[tooltipPlacement]}`}\n          >\n            {tooltipName}\n            <div\n              className={`absolute size-2 bg-gray-900 dark:bg-gray-100 ${tooltipArrowClasses[tooltipPlacement]}`}\n            />\n          </motion.div>\n        )}\n      </AnimatePresence>\n    </motion.div>\n  );\n});\n\n// Utility function - users need to provide this or we bundle it\nfunction cn(...inputs: (string | undefined | null | boolean)[]) {\n  return inputs.filter(Boolean).join(\" \");\n}\n",
      "type": "registry:ui",
      "target": ""
    }
  ]
}